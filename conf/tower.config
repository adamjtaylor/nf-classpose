/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nextflow config file for Seqera Platform (Tower)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/

process {
    // Resource constraints for cloud execution
    cpus   = { 4 * task.attempt }
    memory = { 16.GB * task.attempt }
    time   = { 4.h * task.attempt }

    // Retry with more resources on failure
    errorStrategy = { task.exitStatus in [143,137,104,134,139,140] ? 'retry' : 'finish' }
    maxRetries    = 2

    withLabel: process_gpu {
        cpus   = 4
        memory = 32.GB
        time   = 8.h
    }
}
